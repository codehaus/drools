<?xml version="1.0"?>

<test:suite xmlns:j="jelly:core" 
            xmlns:test="jelly:junit"
           xmlns="jelly:org.drools.smf.SmfTagLibrary">

  <!-- 
    ||
    ||    <module>
    ||
    -->

  <test:case name="module_NoUri">

    <j:catch var="e">
      <module>
      </module>
    </j:catch>
    <test:assert test="${e != null}"> Should have thrown MissingArgumentException: uri</test:assert> 

  </test:case>

  <test:case name="module_Empty_WithUri">
    <module uri="http://drools.org/semantics/test"/>
  </test:case>

  <test:case name="action_NoModule">
    <j:catch var="e">
      <action/>
    </j:catch>
    <test:assert test="${e != null}"> Should have thrown JellyException: not within module</test:assert> 
  </test:case>

  <!-- 
    ||
    ||    <type>
    ||
    -->

  <test:case name="objectType_NoName">
    <module uri="http://drools.org/semantics/test">
      <j:catch var="e">

        <type classname="org.drools.spi.ObjectType"/>

      </j:catch>
      <test:assert test="${e != null}"> Should have thrown MissingAttributeException: name</test:assert> 
    </module>
  </test:case>

  <test:case name="objectType_NoClassname">
    <module uri="http://drools.org/semantics/test">
      <j:catch var="e">

        <type name="testType"/>

      </j:catch>
      <test:assert test="${e != null}"> Should have thrown MissingAttributeException: classname</test:assert> 
    </module>
  </test:case>

  <test:case name="objectType_Valid">
    <module uri="http://drools.org/semantics/test">

      <type name="testType"
            classname="org.drools.spi.ObjectType"/>

     <test:assert test="${semantic_module.getObjectTypeNames().contains('testType')}"/>

    </module> 
  </test:case>

  <!-- 
    ||
    ||    <extractor>
    ||
    -->
  <test:case name="extractor_NoName">
    <module uri="http://drools.org/semantics/test">
      <j:catch var="e">

        <extractor classname="org.drools.spi.FactExtractor"/>

      </j:catch>
      <test:assert test="${e != null}"> Should have thrown MissingAttributeException: name</test:assert> 
    </module>
  </test:case>

  <test:case name="extractor_NoClassname">
    <module uri="http://drools.org/semantics/test">
      <j:catch var="e">

        <extractor name="testExtractor"/>

      </j:catch>
      <test:assert test="${e != null}"> Should have thrown MissingAttributeException: classname</test:assert> 
    </module>
  </test:case>

  <test:case name="extractor_Valid">
    <module uri="http://drools.org/semantics/test">

      <extractor name="testExtractor"
                 classname="org.drools.spi.FactExtractor"/>

     <test:assert test="${semantic_module.getFactExtractorNames().contains('testExtractor')}"/>

    </module> 
  </test:case>

  <!-- 
    ||
    ||    <action>
    ||
    -->

  <test:case name="action_NoName">
    <module uri="http://drools.org/semantics/test">
      <j:catch var="e">

        <action classname="org.drools.spi.Action"/>

      </j:catch>
      <test:assert test="${e != null}"> Should have thrown MissingAttributeException: name</test:assert> 
    </module>
  </test:case>

  <test:case name="action_NoClassname">
    <module uri="http://drools.org/semantics/test">
      <j:catch var="e">

        <action name="testAction"/>

      </j:catch>
      <test:assert test="${e != null}"> Should have thrown MissingAttributeException: classname</test:assert> 
    </module>
  </test:case>

  <test:case name="action_Valid">
    <module uri="http://drools.org/semantics/test">

      <action name="testAction"
            classname="org.drools.spi.Action"/>

     <test:assert test="${semantic_module.getActionNames().contains('testAction')}"/>

    </module> 
  </test:case>
</test:suite>
